<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register â€” Local Talent</title>
  <link rel="stylesheet" href="/landing.css" />
  <style>
    .form-card{max-width:560px;margin:28px auto;padding:20px;background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(2,6,23,.06)}
    label{display:block;margin:8px 0 4px;color:#334155}
    input, select, textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6edf0}
    .muted{color:#6b7280}
    .success{background:#ecfdf5;border:1px solid #bbf7d0;color:#065f46;padding:10px;border-radius:8px}
  </style>
</head>
<body>
  <main class="wrap">
    <div class="form-card">
      <h2>Register as a worker</h2>
      <p class="muted">Fill in your details. This posts to the backend and creates a worker profile.</p>
      <form id="registerForm">
        <label for="name">Full name</label>
        <input id="name" name="name" required />

        <label for="skill">Skill</label>
        <select id="skill" name="skill">
          <option>Tailoring</option>
          <option>Cooking</option>
          <option>Electrician</option>
          <option>Carpentry</option>
          <option>Plumbing</option>
          <option>IT Support</option>
        </select>

        <label for="city">City</label>
        <input id="city" name="city" value="Narasaraopet" />

        <label for="phone">Phone</label>
        <input id="phone" name="phone" placeholder="10-digit phone" />

        <label for="experience">Experience (years)</label>
        <input id="experience" name="experience" placeholder="e.g. 3" />

        <label for="category">Category</label>
        <select id="category" name="category">
          <option>General</option>
          <option>Women</option>
        </select>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center;">
          <button class="btn alt" type="submit">Register</button>
          <a href="/landing.html" class="btn">Back</a>
        </div>
      </form>

      <div id="result" style="margin-top:12px;display:none"></div>
    </div>
  </main>

  <script>
    const form = document.getElementById('registerForm');
    const result = document.getElementById('result');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      result.style.display = 'none';
      const payload = {
        name: document.getElementById('name').value.trim(),
        skill: document.getElementById('skill').value,
        city: document.getElementById('city').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        experience: document.getElementById('experience').value.trim(),
        category: document.getElementById('category').value
      };
      try{
        const res = await fetch('/api/add-worker', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload)});
        const data = await res.json();
        if(res.ok){
          result.className = 'success';
          result.textContent = 'Registered successfully. ID: ' + (data.worker && data.worker.id);
        } else {
          result.className = 'muted';
          result.textContent = (data && data.detail) || 'Error registering';
        }
      }catch(err){
        result.className = 'muted';
        result.textContent = 'Network error: '+err.message;
      }
      result.style.display = 'block';
    });
  </script>
</body>
</html>
